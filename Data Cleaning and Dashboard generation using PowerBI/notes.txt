








StandardizedV has 
-- 533 rows where PPU IS NULL --(DOWN TO 54 AFTER imputesV3) 
// this can still brought down but not necessary anymore since we are only worried about the total sales
   and quantity for our analysis//

//// These 2 columns in between was left with same amount of nulls which makes sense ////
-- 502 TotalSpent NULL-- (DOWN TO 23 AFTER imputesV3) 
-- 479 qUANTITY NULL --(DOWN TO 23 AFTER imputesV3)
//// Since they are closely tied to each other in the calculations from the queries ////

-- 969 ITEM Nulls --(DOWN TO 501 AFTER imputesv3)

-- To manage nulls in both item and ppu

 item  	        ppu
------------|------
COOKIE		1
SANDWICH	4
SALAD		5
CAKE		3
COFFEE		1
JUICE		3
TEA		1.5
SMOOTHIE	4

if the scenario is like this:

ITEM NULL AND PPU IS NOT NULL 
and
PPU IS NULL AND ITEM IS NOT NULL
THEN
We can do a case or a join whatever works better and achieves the desired result faster

-- so 2 joins worked fine and also a CTE 
turns out we didnt need the price_ref table just a CTE is fine

so imputations after this will now take 2 steps since we cant impute values with values that is coming from a non-existent yet table. 

1st 

price and item names will be imputed (proper and complete price values needed for step 2 will come from this) 

2nd 

quantity is calculated not imputed  Using Totalspent / price

Total spent is also calculated using price*quantity 

because of this we might need to impute a 3rd time for total spent (yup i was right)

3rd 

this was needed because by the time we got to imputesV2, total_spent column still has some nulls because some of the values that it's supposed 
to take, does not yet exist from the previous table and would only be aggregated after the 2nd part. 

here we just calculate this column and see if it solves all the quantity nulls if the name is NOT NULL and also get rid of totalspent nulls

4th would be the issue column 
where we can flag the remaining nulls that were specifically not imputed. 

 







3rd STEP
i believe is when we will be ready to make the final version if everything works fine

REMEMBER:
DO NOT IMPUTE NAMES IF THE PRICE IS AMBIGUOUS big nono 
LEAVE THEM NULL we dont wanna invent item names with ambiguous prices or quantities 



 